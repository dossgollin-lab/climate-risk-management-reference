<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Basics of Probability and Statistics ‚Äì Climate Risk Assessment and Management</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/fundamentals/inference.html" rel="next">
<link href="../../index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b0209b97ac5f548e16cda7510b525f86.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/glossary/glossary.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/fundamentals/probability-stats.html">Fundamentals</a></li><li class="breadcrumb-item"><a href="../../chapters/fundamentals/probability-stats.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics of Probability and Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Climate Risk Assessment and Management</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/probability-stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics of Probability and Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference and Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Statistics and Utility Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Time Series and Frequency Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/multidimensional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multidimensional Statistics and Copulas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/model-comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Model Validation and Comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/fundamentals/climate-science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fundamentals of Climate Science</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Climate Hazard Assessment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/hazard/extremes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Extreme Value Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/hazard/downscaling-bias-correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Downscaling and Bias Correction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/hazard/assimilation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Assimilation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/hazard/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Synthetic Events and Optimal Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/hazard/surrogate-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Surrogates and Emulators</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Climate Risk Management</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/risk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Foundations of Risk and Decision-Making Under Uncertainty</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/expectations-cost-benefit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Economic Analysis, Discounting, and Benefit-Cost Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/policy-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Policy Search &amp; Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/robustness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Robustness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/cascading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Cascading Risks and Resilience</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/adaptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Adaptive Planning and Flexibility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/risk-transfer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Risk Transfer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/equity-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Values, Ethics, and Equity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/risk/stakeholders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Stakeholder Engagement and Implementation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../appendices/julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Julia</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#old-stuff" id="toc-old-stuff" class="nav-link" data-scroll-target="#old-stuff"><span class="header-section-number">1.1</span> Old stuff</a></li>
  <li><a href="#what-is-probability" id="toc-what-is-probability" class="nav-link" data-scroll-target="#what-is-probability"><span class="header-section-number">1.2</span> What is probability?</a></li>
  <li><a href="#useful-probability-distributions" id="toc-useful-probability-distributions" class="nav-link" data-scroll-target="#useful-probability-distributions"><span class="header-section-number">1.3</span> Useful Probability distributions</a>
  <ul class="collapse">
  <li><a href="#the-normal-distribution" id="toc-the-normal-distribution" class="nav-link" data-scroll-target="#the-normal-distribution"><span class="header-section-number">1.3.1</span> The Normal distribution</a></li>
  <li><a href="#central-limit-theorem" id="toc-central-limit-theorem" class="nav-link" data-scroll-target="#central-limit-theorem"><span class="header-section-number">1.3.2</span> Central limit theorem</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation"><span class="header-section-number">1.3.3</span> Notation</a></li>
  <li><a href="#normal-pdf" id="toc-normal-pdf" class="nav-link" data-scroll-target="#normal-pdf"><span class="header-section-number">1.3.4</span> Normal PDF</a></li>
  <li><a href="#bernoulli-distribution" id="toc-bernoulli-distribution" class="nav-link" data-scroll-target="#bernoulli-distribution"><span class="header-section-number">1.3.5</span> Bernoulli distribution</a></li>
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution"><span class="header-section-number">1.3.6</span> Binomial distribution</a></li>
  <li><a href="#multinomial-distribution" id="toc-multinomial-distribution" class="nav-link" data-scroll-target="#multinomial-distribution"><span class="header-section-number">1.3.7</span> Multinomial distribution</a></li>
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution"><span class="header-section-number">1.3.8</span> Poisson distribution</a></li>
  <li><a href="#negative-binomial-distribution" id="toc-negative-binomial-distribution" class="nav-link" data-scroll-target="#negative-binomial-distribution"><span class="header-section-number">1.3.9</span> Negative binomial distribution</a></li>
  <li><a href="#what-other-distributions-do-you-know" id="toc-what-other-distributions-do-you-know" class="nav-link" data-scroll-target="#what-other-distributions-do-you-know"><span class="header-section-number">1.3.10</span> What other distributions do you know?</a></li>
  </ul></li>
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics"><span class="header-section-number">1.4</span> Statistics</a>
  <ul class="collapse">
  <li><a href="#mean" id="toc-mean" class="nav-link" data-scroll-target="#mean"><span class="header-section-number">1.4.1</span> Mean</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance"><span class="header-section-number">1.4.2</span> Variance</a></li>
  </ul></li>
  <li><a href="#pdfs-and-cdfs" id="toc-pdfs-and-cdfs" class="nav-link" data-scroll-target="#pdfs-and-cdfs"><span class="header-section-number">1.5</span> PDFs and CDFs</a>
  <ul class="collapse">
  <li><a href="#pdf-and-cdf" id="toc-pdf-and-cdf" class="nav-link" data-scroll-target="#pdf-and-cdf"><span class="header-section-number">1.5.1</span> PDF and CDF</a></li>
  <li><a href="#pdf-example" id="toc-pdf-example" class="nav-link" data-scroll-target="#pdf-example"><span class="header-section-number">1.5.2</span> PDF example</a></li>
  <li><a href="#pmfs" id="toc-pmfs" class="nav-link" data-scroll-target="#pmfs"><span class="header-section-number">1.5.3</span> PMFs</a></li>
  </ul></li>
  <li><a href="#joint-marginal-and-conditional-distributions" id="toc-joint-marginal-and-conditional-distributions" class="nav-link" data-scroll-target="#joint-marginal-and-conditional-distributions"><span class="header-section-number">1.6</span> Joint, marginal, and conditional distributions</a>
  <ul class="collapse">
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule"><span class="header-section-number">1.6.1</span> Bayes‚Äô Rule</a></li>
  <li><a href="#marginal-probability" id="toc-marginal-probability" class="nav-link" data-scroll-target="#marginal-probability"><span class="header-section-number">1.6.2</span> Marginal probability</a></li>
  <li><a href="#joint-probability" id="toc-joint-probability" class="nav-link" data-scroll-target="#joint-probability"><span class="header-section-number">1.6.3</span> Joint probability</a></li>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link" data-scroll-target="#conditional-probability"><span class="header-section-number">1.6.4</span> Conditional probability</a></li>
  <li><a href="#example-two-dice-wager" id="toc-example-two-dice-wager" class="nav-link" data-scroll-target="#example-two-dice-wager"><span class="header-section-number">1.6.5</span> Example: two-dice wager</a></li>
  </ul></li>
  <li><a href="#example-linear-regression" id="toc-example-linear-regression" class="nav-link" data-scroll-target="#example-linear-regression"><span class="header-section-number">1.7</span> Example: linear regression</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">1.7.1</span> Overview</a></li>
  <li><a href="#conditional-distribution-of-y_i" id="toc-conditional-distribution-of-y_i" class="nav-link" data-scroll-target="#conditional-distribution-of-y_i"><span class="header-section-number">1.7.2</span> Conditional distribution of <span class="math inline">\(y_i\)</span></a></li>
  <li><a href="#marginal-distribution-of-y_i" id="toc-marginal-distribution-of-y_i" class="nav-link" data-scroll-target="#marginal-distribution-of-y_i"><span class="header-section-number">1.7.3</span> Marginal distribution of <span class="math inline">\(y_i\)</span></a></li>
  <li><a href="#joint-distribution-of-y_i-and-x_i" id="toc-joint-distribution-of-y_i-and-x_i" class="nav-link" data-scroll-target="#joint-distribution-of-y_i-and-x_i"><span class="header-section-number">1.7.4</span> Joint distribution of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span></a></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation"><span class="header-section-number">1.7.5</span> Simulation</a></li>
  </ul></li>
  <li><a href="#example-negative-binomial-as-a-mixture" id="toc-example-negative-binomial-as-a-mixture" class="nav-link" data-scroll-target="#example-negative-binomial-as-a-mixture"><span class="header-section-number">1.8</span> Example: negative binomial as a mixture</a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1"><span class="header-section-number">1.8.1</span> Overview</a></li>
  <li><a href="#mathematical-derivation" id="toc-mathematical-derivation" class="nav-link" data-scroll-target="#mathematical-derivation"><span class="header-section-number">1.8.2</span> Mathematical derivation</a></li>
  <li><a href="#simulation-example" id="toc-simulation-example" class="nav-link" data-scroll-target="#simulation-example"><span class="header-section-number">1.8.3</span> Simulation example</a></li>
  <li><a href="#so-what" id="toc-so-what" class="nav-link" data-scroll-target="#so-what"><span class="header-section-number">1.8.4</span> So what?</a></li>
  </ul></li>
  <li><a href="#wrapup" id="toc-wrapup" class="nav-link" data-scroll-target="#wrapup"><span class="header-section-number">1.9</span> Wrapup</a>
  <ul class="collapse">
  <li><a href="#key-ideas" id="toc-key-ideas" class="nav-link" data-scroll-target="#key-ideas"><span class="header-section-number">1.9.1</span> Key ideas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/fundamentals/probability-stats.html">Fundamentals</a></li><li class="breadcrumb-item"><a href="../../chapters/fundamentals/probability-stats.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics of Probability and Statistics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics of Probability and Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Understand foundational probability concepts (random variables, distributions, moments).</li>
<li>Apply descriptive and inferential statistical methods to climate-related datasets.</li>
<li>Recognize when and why certain probability models are appropriate for climate variables.</li>
</ul>
<p>Topics</p>
<ul>
<li>Probability distributions (e.g., Normal, Gamma, Exponential) and their properties</li>
<li>Descriptive statistics (mean, variance, quantiles)</li>
<li>Basic hypothesis testing, p-values, and confidence intervals</li>
<li>Common pitfalls in statistical analysis of climate/earth science data</li>
</ul>
</section>
<section id="old-stuff" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="old-stuff"><span class="header-section-number">1.1</span> Old stuff</h2>
<div id="16d9f538" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="what-is-probability" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="what-is-probability"><span class="header-section-number">1.2</span> What is probability?</h2>
</section>
<section id="useful-probability-distributions" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="useful-probability-distributions"><span class="header-section-number">1.3</span> Useful Probability distributions</h2>
<section id="the-normal-distribution" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="the-normal-distribution"><span class="header-section-number">1.3.1</span> The Normal distribution</h3>
<p>The Normal (Gaussian) distribution has <em>probability distribution function</em> <button class="glossary"><span class="def">The derivative of the cumulative distribution function. The probability that a continuous random variable takes on a value in a given range is the integral of the probability density function over that range.</span>probability density function</button>:</p>
<p><span class="math display">\[
p(y | \mu, \theta) = \frac{1}{\sigma\sqrt{2\pi}} \exp
\left(
-\frac{1}{2}\left(
\frac{x-\mu}{\sigma}
\right)^{\!2}
\,
\right)
\]</span></p>
<ul>
<li>Mean <span class="math inline">\(\mu\)</span>
<ul>
<li>Median equal to mean</li>
</ul></li>
<li>Variance <span class="math inline">\(\sigma^2\)</span></li>
<li>Symmetric</li>
</ul>
</section>
<section id="central-limit-theorem" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="central-limit-theorem"><span class="header-section-number">1.3.2</span> Central limit theorem</h3>
<p>The <em>central limit theorem</em> says that the sum of many independent random variables is approximately normally distributed.</p>
<p>We can see this with an example:</p>
<ol type="1">
<li>For each sample <span class="math inline">\(i = 1, \ldots, N\)</span>:
<ol type="1">
<li>Draw <code>J</code> draws from a non-Gaussian distribution <span class="math inline">\(\mathcal{D}\)</span></li>
<li>Take the mean and save it as <span class="math inline">\(\bar{y}_i\)</span></li>
</ol></li>
<li>Plot the distribution of <span class="math inline">\(\bar{y}_i\)</span></li>
</ol>
<div id="975da2f0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1"></a>dist <span class="op">=</span> <span class="fu">Gamma</span>(<span class="fl">2</span>, <span class="fl">1</span>) <span class="co"># a non-Gaussian distribution</span></span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2"></a>N <span class="op">=</span> <span class="fl">10_000</span> <span class="co"># number of samples</span></span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3"></a>J <span class="op">=</span> <span class="fl">500</span> <span class="co"># draws per sample</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4"></a>yÃÑ <span class="op">=</span> [</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-5" class="code-annotation-target"><a href="#annotated-cell-2-5"></a>    <span class="fu">mean</span>(<span class="fu">rand</span>(dist, J)) for _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3">3</button><span id="annotated-cell-2-6" class="code-annotation-target"><a href="#annotated-cell-2-6"></a>]</span>
<span id="annotated-cell-2-7"><a href="#annotated-cell-2-7"></a><span class="fu">hist</span>(</span>
<span id="annotated-cell-2-8"><a href="#annotated-cell-2-8"></a>    yÃÑ;</span>
<span id="annotated-cell-2-9"><a href="#annotated-cell-2-9"></a>    bins<span class="op">=</span><span class="fl">50</span>,</span>
<span id="annotated-cell-2-10"><a href="#annotated-cell-2-10"></a>    axis<span class="op">=</span>(</span>
<span id="annotated-cell-2-11"><a href="#annotated-cell-2-11"></a>        xlabel<span class="op">=</span><span class="st">"Sample mean"</span>,</span>
<span id="annotated-cell-2-12"><a href="#annotated-cell-2-12"></a>        ylabel<span class="op">=</span><span class="st">"Proportion of samples"</span>,</span>
<span id="annotated-cell-2-13"><a href="#annotated-cell-2-13"></a>    ),</span>
<span id="annotated-cell-2-14"><a href="#annotated-cell-2-14"></a>    normalization<span class="op">=:</span>probability</span>
<span id="annotated-cell-2-15"><a href="#annotated-cell-2-15"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="1">To type <code>yÃÑ</code>, type <code>y</code> then type <code>\bar</code> and hit <code>tab</code>. Julia allows unicode (or emojis) in variable names</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="5" data-code-annotation="2">To type <code>‚àà</code> , type <code>\in</code> and hit <code>tab</code>. The <code>_</code> isn‚Äôt doing anything special and we could name it <code>i</code> or üò∂ or whatever we want but <code>_</code> suggests it‚Äôs a throwaway</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="6" data-code-annotation="3">This is another <em>list comprehension</em></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-3-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="notation" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="notation"><span class="header-section-number">1.3.3</span> Notation</h3>
<p>We will get tired of writing</p>
<p><span class="math display">\[
p(y | \mu, \theta) = \frac{1}{\sigma\sqrt{2\pi}} \exp
\left(
-\frac{1}{2}\left(
\frac{x-\mu}{\sigma}
\right)^{\!2}
\,
\right)
\]</span></p>
<p>Instead, we will often use shorthand:</p>
<p><span class="math display">\[
y \sim \mathcal{N}(\mu, \sigma^2)
\]</span></p>
</section>
<section id="normal-pdf" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="normal-pdf"><span class="header-section-number">1.3.4</span> Normal PDF</h3>
<div id="0b767787" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">let</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>    dist <span class="op">=</span> <span class="fu">Normal</span>(<span class="fl">0</span>, <span class="fl">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>    x <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">200</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>    y <span class="op">=</span> <span class="fu">pdf</span>.(dist, x)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>    fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb3-7"><a href="#cb3-7"></a>    ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb3-8"><a href="#cb3-8"></a>        xlabel<span class="op">=</span>L<span class="st">"</span><span class="sc">$</span>x<span class="sc">$</span><span class="st">",</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">        </span>ylabel<span class="st">=L"</span><span class="op">$</span><span class="fu">p</span>(x <span class="op">|</span> <span class="op">\</span>mu<span class="op">=</span><span class="fl">0</span>, <span class="op">\</span>sigma<span class="op">=</span><span class="fl">1</span>)<span class="op">$</span><span class="st">"</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    )</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="fu">lines!</span>(ax, x, y, label<span class="op">=</span><span class="st">"Normal Distribution"</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="fu">axislegend</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a>    fig</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-4-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>L"&lt;string&gt;"</code> allows us to use LaTeX in strings</li>
<li>This notation specifies the values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span></li>
</ol>
</section>
<section id="bernoulli-distribution" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="bernoulli-distribution"><span class="header-section-number">1.3.5</span> Bernoulli distribution</h3>
<p>A Bernoulli distribution models a coin flip.</p>
<div id="7e59217b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1"></a>p <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># probability of heads</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2"></a><span class="fu">rand</span>(<span class="fu">Bernoulli</span>(p), <span class="fl">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Draw 5 samples from the Bernoulli distribution with parameter <code>p</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>5-element Vector{Bool}:
 0
 1
 1
 0
 1</code></pre>
</div>
</div>
</section>
<section id="binomial-distribution" class="level3" data-number="1.3.6">
<h3 data-number="1.3.6" class="anchored" data-anchor-id="binomial-distribution"><span class="header-section-number">1.3.6</span> Binomial distribution</h3>
<p>A Binomial distribution models the distribution of <code>n</code> consecutive flips of the same coin</p>
<div id="40959fa5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1"></a>p <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>N <span class="op">=</span> <span class="fl">5</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">rand</span>(<span class="fu">Binomial</span>(N, p), <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>5-element Vector{Int64}:
 3
 1
 1
 0
 4</code></pre>
</div>
</div>
</section>
<section id="multinomial-distribution" class="level3" data-number="1.3.7">
<h3 data-number="1.3.7" class="anchored" data-anchor-id="multinomial-distribution"><span class="header-section-number">1.3.7</span> Multinomial distribution</h3>
<p>The Multinomial extends the Binomial to multiple categories. Note that <code>p</code> is a <em>vector</em>. If there are 2 categories (<span class="math inline">\(K=2\)</span>), it‚Äôs just the binomial with <span class="math inline">\(p_\text{multinomial} = [p, 1-p]\)</span>.‚Äù</p>
<div id="341508bd" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1"></a>p <span class="op">=</span> [<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>]</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2"></a>N <span class="op">=</span> <span class="fl">5</span></span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3"></a>dist <span class="op">=</span> <span class="fu">Multinomial</span>(N, p)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-4" class="code-annotation-target"><a href="#annotated-cell-6-4"></a><span class="fu">rand</span>(dist, <span class="fl">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="4" data-code-annotation="1">To be more concise, we could write <code>rand(Multinimial([0.5, 0.3, 0.2], 5), 5)</code>. Which is more readable?</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>3√ó5 Matrix{Int64}:
 2  4  2  2  2
 2  0  2  0  1
 1  1  1  3  2</code></pre>
</div>
</div>
</section>
<section id="poisson-distribution" class="level3 scrollable" data-number="1.3.8">
<h3 class="scrollable anchored" data-number="1.3.8" data-anchor-id="poisson-distribution"><span class="header-section-number">1.3.8</span> Poisson distribution</h3>
<p>The Poisson distribution is used to model count data. It is the limit of a Binomial distribution with <span class="math inline">\(p=\lambda/N\)</span>, as <span class="math inline">\(N \rightarrow \infty\)</span>.</p>
<p>A Poisson distribution has mean and variance equal to <span class="math inline">\(\lambda\)</span>.</p>
<div id="4d92847f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-1" class="code-annotation-target"><a href="#annotated-cell-7-1"></a>dist <span class="op">=</span> <span class="fu">Poisson</span>(<span class="fl">2.5</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2"></a><span class="fu">rand</span>(dist, <span class="fl">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="1" data-code-annotation="1">The Poisson distribution has one parameter, <span class="math inline">\(\lambda\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="2">Draw 10 samples from the Poisson distribution</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>10-element Vector{Int64}:
 3
 2
 4
 7
 2
 4
 4
 2
 1
 2</code></pre>
</div>
</div>
</section>
<section id="negative-binomial-distribution" class="level3" data-number="1.3.9">
<h3 data-number="1.3.9" class="anchored" data-anchor-id="negative-binomial-distribution"><span class="header-section-number">1.3.9</span> Negative binomial distribution</h3>
<p>The <code>NegativeBinomaial</code> distribution relaxes the Poisson‚Äôs assumotion that <span class="math inline">\(\text{mean} = \text{variance}\)</span>.</p>
<p>This distribution models the number of successes in a sequence of independent and identically distributed Bernoulli trials with probability <code>p</code> before a specified (non-random) number of failures (<code>r</code>) occurs. For example, we can define rolling a 6 on a dice as a failure, and rolling any other number as a success, and ask how many successful rolls will occur before we see the third failure (<code>p = 1/6</code> and <code>r = 3</code>).</p>
</section>
<section id="what-other-distributions-do-you-know" class="level3" data-number="1.3.10">
<h3 data-number="1.3.10" class="anchored" data-anchor-id="what-other-distributions-do-you-know"><span class="header-section-number">1.3.10</span> What other distributions do you know?</h3>
<p>. . .</p>
<ul>
<li>Uniform</li>
<li>Exponential</li>
<li>Gamma (see above)</li>
<li>Beta</li>
<li>Pareto</li>
<li>Student t</li>
<li>Boltzmann</li>
<li>Many more!</li>
</ul>
</section>
</section>
<section id="statistics" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="statistics"><span class="header-section-number">1.4</span> Statistics</h2>
<section id="mean" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="mean"><span class="header-section-number">1.4.1</span> Mean</h3>
<p>The mean of a sample is just the sample average: <span class="math display">\[
\bar{y} = \frac{1}{N} \sum_{i=1}^N y_i
\]</span></p>
<p>. . .</p>
<p>The mean of a distribution is the expected value of the distribution: <span class="math display">\[
\mathbb{E}(u) = \int u p(u) \, du
\]</span></p>
</section>
<section id="variance" class="level3 smaller" data-number="1.4.2">
<h3 class="smaller anchored" data-number="1.4.2" data-anchor-id="variance"><span class="header-section-number">1.4.2</span> Variance</h3>
<p>Variance measures how points differ from the mean</p>
<p>. . .</p>
<p>You may be familiar with sample variance: <span class="math display">\[
S^2 = \frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n - 1}
\]</span></p>
<p>. . .</p>
<p>For a distribution: <span class="math display">\[
\mathbb{V}(u) = \int (u - \mathbb{E}(u))^2 p(u) \, du
\]</span> or, for a vector <span class="math display">\[
\mathbb{V}(u) = \int (u - \mathbb{E}(u)) (u - \mathbb{E}(u))^T p(u) \, du
\]</span></p>
</section>
</section>
<section id="pdfs-and-cdfs" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="pdfs-and-cdfs"><span class="header-section-number">1.5</span> PDFs and CDFs</h2>
<section id="pdf-and-cdf" class="level3 smaller scrollable" data-number="1.5.1">
<h3 class="smaller scrollable anchored" data-number="1.5.1" data-anchor-id="pdf-and-cdf"><span class="header-section-number">1.5.1</span> PDF and CDF</h3>
<p>If <span class="math inline">\(F_X\)</span> is the <em>cumulative distribution function</em> (CDF) of <span class="math inline">\(X\)</span> and <span class="math inline">\(f_X\)</span> is the <em>probability density function</em> (PDF) of <span class="math inline">\(X\)</span>, then: <span class="math display">\[
F_X ( x ) = \int_{-\infty}^x f_X(u) \, du,
\]</span></p>
<p>and (if <span class="math inline">\(f_X\)</span> is continuous at <span class="math inline">\(x\)</span> which it typically will be) <span class="math display">\[
f_{X}(x)={\frac {d}{dx}}F_{X}(x).
\]</span> A useful property is <span class="math display">\[
\Pr[a\leq X\leq b]=\int _{a}^{b}f_{X}(x)\,dx
\]</span></p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We can only talk about the probability that <span class="math inline">\(y\)</span> is in some interval <span class="math inline">\([a, b]\)</span>, which is given by the integral of the PDF over that interval. The probability that <span class="math inline">\(y\)</span> takes on the value <span class="math inline">\(y^*\)</span>, written <span class="math inline">\(p(y=y^*)\)</span>, is zero.</p>
</div>
</div>
</div>
</section>
<section id="pdf-example" class="level3 scrollable" data-number="1.5.2">
<h3 class="scrollable anchored" data-number="1.5.2" data-anchor-id="pdf-example"><span class="header-section-number">1.5.2</span> PDF example</h3>
<div id="d61c0c29" class="cell" data-show="false" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## https://www.matecdev.com/posts/julia-numerical-integration.html</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">function</span> <span class="fu">quad_trap</span>(f, a, b, N)</span>
<span id="cb10-3"><a href="#cb10-3"></a>    h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> N</span>
<span id="cb10-4"><a href="#cb10-4"></a>    int <span class="op">=</span> h <span class="op">*</span> (<span class="fu">f</span>(a) <span class="op">+</span> <span class="fu">f</span>(b)) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>        xk <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">*</span> k <span class="op">/</span> N <span class="op">+</span> a</span>
<span id="cb10-7"><a href="#cb10-7"></a>        int <span class="op">=</span> int <span class="op">+</span> h <span class="op">*</span> <span class="fu">f</span>(xk)</span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="cf">end</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>    <span class="cf">return</span> int</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Simple example to illustrate that <span class="math display">\[
F_X(2) = \int_{-\infty}^2 f_X(u) \, du
\]</span></p>
<p>We will use a standard Normal distribution as an example</p>
<div id="be769783" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1"></a>dist <span class="op">=</span> <span class="fu">Normal</span>() <span class="co">#</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-2" class="code-annotation-target"><a href="#annotated-cell-9-2"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">pdf</span>(dist, x) <span class="co">#</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-3" class="code-annotation-target"><a href="#annotated-cell-9-3"></a>approx <span class="op">=</span> <span class="fu">quad_trap</span>(f, <span class="op">-</span><span class="fl">100</span>, <span class="fl">2</span>, <span class="fl">1000</span>) <span class="co">#</span></span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4"></a>exact <span class="op">=</span> <span class="fu">cdf</span>(dist, <span class="fl">2</span>)</span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5"></a></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6"></a>approx, exact</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1" data-code-annotation="1">Mean 0 and standard deviation 1 by default</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="2" data-code-annotation="2"><code>pdf(d, x)</code> tells us the probability density function of distribution <code>d</code> evaluated at <code>x</code></span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="3" data-code-annotation="3"><code>quad_trap</code> is a trapezoidal approximation of the integral with arguments: function, lower bound, upper bound, and number of points</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(0.9771562639858903, 0.9772498680518208)</code></pre>
</div>
</div>
</section>
<section id="pmfs" class="level3 scrollable" data-number="1.5.3">
<h3 class="scrollable anchored" data-number="1.5.3" data-anchor-id="pmfs"><span class="header-section-number">1.5.3</span> PMFs</h3>
<div id="f3063d4f" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1"></a>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>y <span class="op">=</span> <span class="fu">pdf</span>.(<span class="fu">Poisson</span>(<span class="fl">5</span>), x)</span>
<span id="cb12-3"><a href="#cb12-3"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb12-4"><a href="#cb12-4"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb12-5"><a href="#cb12-5"></a>    xlabel<span class="op">=</span>L<span class="st">"x^*"</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>    ylabel<span class="op">=</span>L<span class="st">"p(x=x^*)"</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="fu">scatter!</span>(ax, x, y; label<span class="op">=</span><span class="st">"PMF"</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="fu">lines!</span>(ax, x, y)</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="fu">axislegend</span>()</span>
<span id="cb12-11"><a href="#cb12-11"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-11-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="joint-marginal-and-conditional-distributions" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="joint-marginal-and-conditional-distributions"><span class="header-section-number">1.6</span> Joint, marginal, and conditional distributions</h2>
<section id="bayes-rule" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="bayes-rule"><span class="header-section-number">1.6.1</span> Bayes‚Äô Rule</h3>
<p><span class="math display">\[
p(\theta, y) = p(\theta) p(y | \theta)
\]</span> and thus <span class="math display">\[
p(\theta | y) = \frac{p(\theta, y)}{p(y)} = \frac{p(\theta) p(y | \theta)}{p(y)}
\]</span> generally: <span class="math display">\[
p(\theta | y) \propto p(\theta) p(y | \theta)
\]</span></p>
</section>
<section id="marginal-probability" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="marginal-probability"><span class="header-section-number">1.6.2</span> Marginal probability</h3>
<p>Probability of event <span class="math inline">\(A\)</span>: <span class="math inline">\(\Pr(A)\)</span></p>
<p>. . .</p>
<p>We will write the marginal probability density function as <span class="math display">\[
p(\theta) \quad \text{or} \quad p(y)
\]</span></p>
</section>
<section id="joint-probability" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="joint-probability"><span class="header-section-number">1.6.3</span> Joint probability</h3>
<p>Probability of events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>: <span class="math inline">\(\Pr(A  \&amp; B)\)</span></p>
<p>. . .</p>
<p><span class="math display">\[
p(\theta, y)
\]</span></p>
</section>
<section id="conditional-probability" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="conditional-probability"><span class="header-section-number">1.6.4</span> Conditional probability</h3>
<p>Probability of event <span class="math inline">\(A\)</span> given event <span class="math inline">\(B\)</span>: <span class="math inline">\(\Pr(A | B)\)</span></p>
<p>. . .</p>
<p><span class="math display">\[
p(\theta | y) \quad \text{or} \quad p(y | \theta)
\]</span></p>
</section>
<section id="example-two-dice-wager" class="level3" data-number="1.6.5">
<h3 data-number="1.6.5" class="anchored" data-anchor-id="example-two-dice-wager"><span class="header-section-number">1.6.5</span> Example: two-dice wager</h3>
<blockquote class="blockquote">
<p>A gambler presents you with an even-money wager. You will roll two dice, and if the highest number showing is one, two, three or four, then you win. If the highest number on either die is five or six, then she wins. Should you take the bet?</p>
</blockquote>
</section>
</section>
<section id="example-linear-regression" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="example-linear-regression"><span class="header-section-number">1.7</span> Example: linear regression</h2>
<section id="overview" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1.7.1</span> Overview</h3>
<p>Standard linear regression model, let‚Äôs assume <span class="math inline">\(x \in \mathbb{R}\)</span> for simplicity (1 predictor): <span class="math display">\[
y_i = ax_i + b + \epsilon_i
\]</span> where <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>.</p>
</section>
<section id="conditional-distribution-of-y_i" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="conditional-distribution-of-y_i"><span class="header-section-number">1.7.2</span> Conditional distribution of <span class="math inline">\(y_i\)</span></h3>
<p>The conditional probability density of <span class="math inline">\(y_i\)</span> given <span class="math inline">\(x_i\)</span> is <span class="math display">\[
p(y_i | x_i, a, b, \sigma) = N(ax_i + b, \sigma^2)
\]</span> which is a shorthand for writing out the full equation for the Normal PDF. We can (and often will) write this as <span class="math display">\[
y_i \sim \mathcal{N}(ax_i + b, \sigma^2)
\]</span> Finally, we will sometimes write <span class="math inline">\(p(y_i | x_i)\)</span> as a shorthand for <span class="math inline">\(p(y_i | x_i, a, b, \sigma)\)</span>. While fine in many circumstances, we should take care to make sure we are extremely clear about what parameters we are conditioning on.</p>
</section>
<section id="marginal-distribution-of-y_i" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="marginal-distribution-of-y_i"><span class="header-section-number">1.7.3</span> Marginal distribution of <span class="math inline">\(y_i\)</span></h3>
<p>The marginal probability density of <span class="math inline">\(y_i\)</span> is <span class="math display">\[
p(y_i | a, b, \sigma) = \int p(y_i | x_i, a, b, \sigma) p(x_i) \, dx_i
\]</span> where <span class="math inline">\(p(x_i)\)</span> is the probability density of <span class="math inline">\(x_i\)</span>.</p>
</section>
<section id="joint-distribution-of-y_i-and-x_i" class="level3" data-number="1.7.4">
<h3 data-number="1.7.4" class="anchored" data-anchor-id="joint-distribution-of-y_i-and-x_i"><span class="header-section-number">1.7.4</span> Joint distribution of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span></h3>
<p>The joint probability density of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> is <span class="math display">\[
p(y_i, x_i | a, b, \sigma) = p(y_i | x_i, a, b, \sigma) p(x_i)
\]</span> where <span class="math inline">\(p(x_i)\)</span> is the probability density of <span class="math inline">\(x_i\)</span>.</p>
</section>
<section id="simulation" class="level3 scrollable smaller" data-number="1.7.5">
<h3 class="scrollable smaller anchored" data-number="1.7.5" data-anchor-id="simulation"><span class="header-section-number">1.7.5</span> Simulation</h3>
<div id="bfe1bdcd" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1"></a>m <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>b <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>œÉ <span class="op">=</span> <span class="fl">1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>If <span class="math inline">\(x=2\)</span>, we can simulate from the conditional distribution of <span class="math inline">\(y\)</span>:</p>
<div id="fb97a6c6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1"></a>N_sim <span class="op">=</span> <span class="fl">10_000</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>x <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>y <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">Normal</span>(m <span class="op">*</span> x <span class="op">+</span> b, œÉ), N_sim)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb15-6"><a href="#cb15-6"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb15-7"><a href="#cb15-7"></a>    title<span class="op">=</span>L<span class="st">"p(y | x=2)"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>    xlabel<span class="op">=</span>L<span class="st">"y"</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>    ylabel<span class="op">=</span><span class="st">"Density"</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="fu">hist!</span>(ax, y; bins<span class="op">=</span><span class="fl">50</span>, normalization<span class="op">=:</span>pdf, label<span class="op">=</span><span class="st">"Sampled"</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="fu">axislegend</span>()</span>
<span id="cb15-13"><a href="#cb15-13"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-13-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If <span class="math inline">\(x \sim N(0, 1)\)</span>, then we can simulate from the joint distribution of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:</p>
<div id="5892cd3b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode numberSource julia code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode julia"><span id="annotated-cell-13-1"><a href="#annotated-cell-13-1"></a>x <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">Normal</span>(<span class="fl">0</span>, <span class="fl">1</span>), <span class="fl">10_000</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="1">1</button><span id="annotated-cell-13-2" class="code-annotation-target"><a href="#annotated-cell-13-2"></a>y <span class="op">=</span> [<span class="fu">rand</span>(<span class="fu">Normal</span>(m <span class="op">*</span> x·µ¢ <span class="op">+</span> b, œÉ)) for x·µ¢ <span class="kw">in</span> x] <span class="co">#</span></span>
<span id="annotated-cell-13-3"><a href="#annotated-cell-13-3"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="annotated-cell-13-4"><a href="#annotated-cell-13-4"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="annotated-cell-13-5"><a href="#annotated-cell-13-5"></a>    xlabel<span class="op">=</span>L<span class="st">"x"</span>,</span>
<span id="annotated-cell-13-6"><a href="#annotated-cell-13-6"></a>    ylabel<span class="op">=</span>L<span class="st">"y"</span></span>
<span id="annotated-cell-13-7"><a href="#annotated-cell-13-7"></a>)</span>
<span id="annotated-cell-13-8"><a href="#annotated-cell-13-8"></a><span class="fu">scatter!</span>(ax, x, y; label<span class="op">=</span>L<span class="st">"p(x,y)"</span>)</span>
<span id="annotated-cell-13-9"><a href="#annotated-cell-13-9"></a><span class="fu">axislegend</span>()</span>
<span id="annotated-cell-13-10"><a href="#annotated-cell-13-10"></a>fig</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="2" data-code-annotation="1">A list comprehension here is less elegant than writing <code>rand.(Normal.(m .* x .+ b, œÉ))</code> but it is easy to read. The results are the same.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-14-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Finally, assuming the same distribution, we can simulate from the marginal distribution of <span class="math inline">\(y\)</span>:</p>
<div id="88dd771f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb18-2"><a href="#cb18-2"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb18-3"><a href="#cb18-3"></a>    xlabel<span class="op">=</span>L<span class="st">"y"</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>    ylabel<span class="op">=</span><span class="st">"Density"</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>)</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="fu">hist!</span>(ax, y; bins<span class="op">=</span><span class="fl">50</span>, normalization<span class="op">=:</span>pdf, label<span class="op">=</span>L<span class="st">"p(y)"</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="fu">axislegend</span>()</span>
<span id="cb18-8"><a href="#cb18-8"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-15-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="example-negative-binomial-as-a-mixture" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="example-negative-binomial-as-a-mixture"><span class="header-section-number">1.8</span> Example: negative binomial as a mixture</h2>
<section id="overview-1" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="overview-1"><span class="header-section-number">1.8.1</span> Overview</h3>
<p>The Negative Binomial distribution (see last lecture) can be interpreted as a Gamma-Poisson <em>mixture</em>:</p>
<p><span class="math display">\[
\begin{align}
y &amp;\sim \textrm{Poisson}(\lambda) \\
\lambda &amp;\sim \textrm{Gamma}\left(r, \frac{p}{1-p} \right)
\end{align}
\]</span></p>
</section>
<section id="mathematical-derivation" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="mathematical-derivation"><span class="header-section-number">1.8.2</span> Mathematical derivation</h3>
<p>We can show mathematically that if <span class="math inline">\(y ~ \textrm{Negative Binomial}(r, p)\)</span>, that is equivalent to the mixture model <span class="math inline">\(y ~ \textrm{Poisson}(\lambda)\)</span> and <span class="math inline">\(\lambda ~ \textrm{Gamma}(r, p / (1 - p))\)</span>. <span class="math display">\[
\begin{align}
&amp; \int_0^{\infty} f_{\text {Poisson }(\lambda)}(y) \times f_{\operatorname{Gamma}\left(r, \frac{p}{1-p}\right)}(\lambda) \mathrm{d} \lambda \\
&amp; = \int_0^{\infty} \frac{\lambda^y}{y !} e^{-\lambda} \times \frac{1}{\Gamma(r)}\left(\frac{p}{1-p} \lambda\right)^{r-1} e^{-\frac{p}{1-p} \lambda}\left(\frac{p}{1-p} \mathrm{~d} \lambda\right) \\
\ldots \\
&amp;= f_{\text {Negative Binomial }(r, p)}(y)
\end{align}
\]</span> For all the steps see <a href="https://en.wikipedia.org/wiki/Negative_binomial_distribution#Gamma%E2%80%93Poisson_mixture" target="_blank">Wikipedia</a>.</p>
</section>
<section id="simulation-example" class="level3 scrollable" data-number="1.8.3">
<h3 class="scrollable anchored" data-number="1.8.3" data-anchor-id="simulation-example"><span class="header-section-number">1.8.3</span> Simulation example</h3>
<p>We can see this with simulation. First we define a function to simulate from the Gamma-Poisson mixture:</p>
<div id="fd90ea65" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">function</span> <span class="fu">gamma_poisson</span>(r, p)</span>
<span id="cb20-2"><a href="#cb20-2"></a>    g_dist <span class="op">=</span> <span class="fu">Gamma</span>(r, (<span class="fl">1</span> <span class="op">-</span> p) <span class="op">/</span> p)</span>
<span id="cb20-3"><a href="#cb20-3"></a>    Œª <span class="op">=</span> <span class="fu">rand</span>(g_dist)</span>
<span id="cb20-4"><a href="#cb20-4"></a>    p_dist <span class="op">=</span> <span class="fu">Poisson</span>(Œª)</span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="cf">return</span> <span class="fu">rand</span>(p_dist)</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>gamma_poisson (generic function with 1 method)</code></pre>
</div>
</div>
<p>. . .</p>
<p>Then we can simulate from the mixture and compare to the Negative Binomial distribution:</p>
<div id="7da16f8e" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1"></a>r <span class="op">=</span> <span class="fl">3</span> <span class="co"># number of failures</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>p <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span> <span class="co"># probability of failure</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>dist <span class="op">=</span> <span class="fu">NegativeBinomial</span>(r, p)</span>
<span id="cb22-4"><a href="#cb22-4"></a></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co"># simulate rolls</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>N <span class="op">=</span> <span class="fl">1_000_000</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>rolls <span class="op">=</span> [<span class="fu">gamma_poisson</span>(r, p) for _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N]</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co"># plot the samples</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>xticks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span> <span class="co"># specify the bin values</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>fig <span class="op">=</span> <span class="fu">Figure</span>()</span>
<span id="cb22-12"><a href="#cb22-12"></a>ax <span class="op">=</span> <span class="fu">Axis</span>(fig[<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb22-13"><a href="#cb22-13"></a>    xlabel<span class="op">=</span><span class="st">"Number of rolls"</span>,</span>
<span id="cb22-14"><a href="#cb22-14"></a>    ylabel<span class="op">=</span><span class="st">"PMF"</span>,</span>
<span id="cb22-15"><a href="#cb22-15"></a>)</span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co"># Add histogram of simulated data</span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="fu">hist!</span>(ax, rolls;</span>
<span id="cb22-19"><a href="#cb22-19"></a>    bins<span class="op">=</span><span class="fu">length</span>(xticks) <span class="op">+</span> <span class="fl">1</span>,</span>
<span id="cb22-20"><a href="#cb22-20"></a>    normalization<span class="op">=:</span>pdf,</span>
<span id="cb22-21"><a href="#cb22-21"></a>    label<span class="op">=</span><span class="st">"Gamma-Poisson"</span>,</span>
<span id="cb22-22"><a href="#cb22-22"></a>)</span>
<span id="cb22-23"><a href="#cb22-23"></a></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co"># Add the PDF of the negative binomial distribution</span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="fu">lines!</span>(ax, xticks, <span class="fu">pdf</span>.(dist, xticks);</span>
<span id="cb22-26"><a href="#cb22-26"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb22-27"><a href="#cb22-27"></a>    label<span class="op">=</span><span class="st">"Neg. Binom."</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>)</span>
<span id="cb22-29"><a href="#cb22-29"></a></span>
<span id="cb22-30"><a href="#cb22-30"></a><span class="fu">xlims!</span>(ax, <span class="fl">0</span>, <span class="fl">60</span>)</span>
<span id="cb22-31"><a href="#cb22-31"></a><span class="fu">axislegend</span>()</span>
<span id="cb22-32"><a href="#cb22-32"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îå Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
‚îî @ Makie ~/.julia/packages/Makie/Y3ABD/src/scenes.jl:238</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<figure class="figure">
<p><img src="probability-stats_files/figure-html/cell-17-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="so-what" class="level3 smaller scrollable" data-number="1.8.4">
<h3 class="smaller scrollable anchored" data-number="1.8.4" data-anchor-id="so-what"><span class="header-section-number">1.8.4</span> So what?</h3>
<p>I don‚Äôt need you to know all the details of this particular mixture model. What I <em>do</em> want you to understand is:</p>
<ol type="1">
<li>We can model data using combinations of simpler distributions</li>
<li>We can use simple simulation approaches to approximate more complex relationships
<ol type="1">
<li>For example, if we wanted to know <span class="math inline">\(\Pr(y &gt; 10)\)</span> when <span class="math inline">\(y \sim \text{Negative Binomial}(r, p)\)</span> but we didn‚Äôt have a Negative Binomial distribution in our software package we could estimate our quantity of interest</li>
<li>This isn‚Äôt very interesting for this model (there is an analytic solution!) but lots of models we might want to write down don‚Äôt have analytic solutions</li>
</ol></li>
</ol>
</section>
</section>
<section id="wrapup" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="wrapup"><span class="header-section-number">1.9</span> Wrapup</h2>
<section id="key-ideas" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="key-ideas"><span class="header-section-number">1.9.1</span> Key ideas</h3>
<ul>
<li>Conditional probability</li>
<li>Joint probability</li>
<li>Marginal probability</li>
<li>Bayes‚Äô Rule</li>
<li>Likelihood</li>
<li>Posterior</li>
<li>Simulation methods</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/fundamentals/inference.html" class="pagination-link" aria-label="Inference and Optimization">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inference and Optimization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>